
<!DOCTYPE html>
<html lang="en" class="loading">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>flink-1.10.0 源码编译(踩坑记) - Toretto&#39;s Blog</title>
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="google" content="notranslate" />
    <meta name="keywords" content="TriDiamond Obsidian,"> 
    <meta name="description" content="学习开源框架源码是技术进步的重要渠道，但成熟的开源框架源码往往多模块化，设计庞大，考虑的因素和维度较多，导致源码晦涩难懂。直接阅读源码学习往往收效甚微。一般都要将源码clone下来编译，IDE DE,"> 
    <meta name="author" content="lixiaolevae"> 
    <link rel="alternative" href="atom.xml" title="Toretto&#39;s Blog" type="application/atom+xml"> 
    <link rel="icon" href="/img/favicon.png"> 
    <link href="https://fonts.loli.net/css?family=Roboto+Mono|Rubik&display=swap" rel="stylesheet">
    
<link rel="stylesheet" href="//at.alicdn.com/t/font_1429596_nzgqgvnmkjb.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.7.2/animate.min.css">

    
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/codemirror.min.css">

    
<link rel="stylesheet" href="//cdn.bootcss.com/codemirror/5.48.4/theme/dracula.css">

    
<link rel="stylesheet" href="/css/obsidian.css">

    
<link rel="stylesheet" href="/css/ball-atom.min.css">

<meta name="generator" content="Hexo 4.2.0"></head>


<body class="loading">
    <div class="loader">
        <div class="la-ball-atom la-2x">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>
    <span id="config-title" style="display:none">Toretto&#39;s Blog</span>
    <div id="loader"></div>
    <div id="single">
    <div class="scrollbar gradient-bg-rev"></div>
<div id="top" style="display: block;">
    <div class="bar" style="width: 0;"></div>
    <div class="navigation animated fadeIn fast delay-1s">
        <img id="home-icon" class="icon-home" src="/img/favicon.png" alt="" data-url="http://yoursite.com">
        <div id="play-icon" title="Play/Pause" class="iconfont icon-play"></div>
        <h3 class="subtitle">flink-1.10.0 源码编译(踩坑记)</h3>
        <div class="social">
            <!--        <div class="like-icon">-->
            <!--            <a href="javascript:;" class="likeThis active"><span class="icon-like"></span><span class="count">76</span></a>-->
            <!--        </div>-->
            <div>
                <div class="share">
                    
                        <a href="javascript:;" class="iconfont icon-share1"></a>
                        <div class="share-component-cc" data-disabled="facebook,douban,linkedin,diandian,tencent,google"></div>
                    
                </div>
            </div>
        </div>
    </div>
</div>

    <div class="section">
        <div class=article-header-wrapper>
    <div class="article-header">
        <div class="article-cover animated fadeIn" style="
            animation-delay: 600ms;
            animation-duration: 1.2s;
            background-image: 
                radial-gradient(ellipse closest-side, rgba(0, 0, 0, 0.65), #100e17),
                url(https://tva1.sinaimg.cn/large/00831rSTly1gdc0i35x8cj30rs0rs400.jpg) ">
        </div>
        <div class="else">
            <p class="animated fadeInDown">
                
                <a href="/categories/大数据"><b>「
                    </b>大数据<b> 」</b></a>
                
                March 30, 2020
            </p>
            <h3 class="post-title animated fadeInDown"><a href="/2020/03/30/flink-1-10-0-%E6%BA%90%E7%A0%81%E7%BC%96%E8%AF%91-%E8%B8%A9%E5%9D%91%E8%AE%B0/" title="flink-1.10.0 源码编译(踩坑记)" class="">flink-1.10.0 源码编译(踩坑记)</a>
            </h3>
            
            <p class="post-count animated fadeInDown">
                
                <span>
                    <b class="iconfont icon-text2"></b> <i>Words count</i>
                    24k
                </span>
                
                
                <span>
                    <b class="iconfont icon-timer__s"></b> <i>Reading time</i>
                    22 mins.
                </span>
                
                
                <span id="/2020/03/30/flink-1-10-0-源码编译-踩坑记/" class="leancloud_visitors" data-flag-title="flink-1.10.0 源码编译(踩坑记)">
                    <b class="iconfont icon-read"></b> <i>Read count</i>
                    <span class="leancloud-visitors-count">1000000</span>
                </span>
                
                
            </p>
            
            
            <ul class="animated fadeInDown post-tags-list" itemprop="keywords"><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/flink/" rel="tag">flink</a></li><li class="animated fadeInDown post-tags-list-item"><a class="animated fadeInDown post-tags-list-link" href="/tags/%E6%BA%90%E7%A0%81/" rel="tag">源码</a></li></ul>
            
        </div>
    </div>
</div>

<div class="screen-gradient-after">
    <div class="screen-gradient-content">
        <div class="screen-gradient-content-inside">
            <div class="bold-underline-links screen-gradient-sponsor">
                <p>
                    <span class="animated fadeIn delay-1s"></span>
                </p>
            </div>
        </div>
    </div>
</div>

<div class="article">
    <div class='main'>
        <div class="content markdown animated fadeIn">
            <p>学习开源框架源码是技术进步的重要渠道，但成熟的开源框架源码往往多模块化，设计庞大，考虑的因素和维度较多，导致源码晦涩难懂。直接阅读源码学习往往收效甚微。一般都要将源码clone下来编译，IDE DEBUG模式运行，边调试边领悟源码内容和其中的设计，这样才能提高学习效率。</p>
<p>2月flink发布了最新的1.10.0版本，小编进行了源码编译用于调试学习，本文详细记录了整个源码编译的过程，其中遇到的一些问题做了记录并提供了解决方案供大家参考，本文若有错误之处恳请大家指出。为了技术一起进步！</p>
<h3 id="前提环境："><a href="#前提环境：" class="headerlink" title="前提环境："></a>前提环境：</h3><p>(括号中是笔者使用的版本)</p>
<p>IDE(IntelliJ IDEA2018.1-且IDEA已安装scala插件。另: IDEA scala插件安装步骤 -&gt; Preferences -&gt; Plugins-&gt;search <code>Scala</code> -&gt; install -&gt; 重启IDEA)</p>
<p>Git(2.24.0)</p>
<p>JDK (1.8)</p>
<p>Maven(3.5.4)</p>
<h3 id="克隆项目："><a href="#克隆项目：" class="headerlink" title="克隆项目："></a>克隆项目：</h3><p>1.克隆项目，从github无论是git clone还是web下载source.zip网络都很慢，一个很好的解决办法是从<strong>码云(Gitee)</strong>去克隆下载。</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysogb73j318d0u0dmm.jpg" alt="image-20200303154621178"></p>
<p>浏览器搜索码云，进入官网注册一个账号，进入后搜索flink仓库，发现有从github原生的flink镜像仓库。码云每天都会从github同步更新比较流行的仓库镜像。因此我们可以从这克隆代码，因为码云是国内的，固然下载速度那是要飞起。</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbyshm4xbj30z40u0jxo.jpg" alt="image-20200303154817076"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysl7elaj312j0u0dqv.jpg" alt="image-20200303154909135"></p>
<pre><code>cd flink-source
git clone https://gitee.com/mirrors/apache-flink.git</code></pre><h3 id="项目导入IDE："><a href="#项目导入IDE：" class="headerlink" title="项目导入IDE："></a>项目导入IDE：</h3><p>进入IDE，笔者使用的IntelliJ IDEA，</p>
<ol>
<li><p>最上方标题栏处点击 “New -&gt; Project from Existing Sources”<img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbyskoddaj315a0li0yi.jpg" alt="image-20200303161426326"></p>
</li>
<li><p>选择刚克隆下来的项目根目录</p>
</li>
<li><p>选择 “Import project from external model”后选择“Maven” icon</p>
</li>
<li><p>接下来的几个窗口中属性不要动保持默认值，一直点击next直到出现SDK配置窗口</p>
</li>
<li><p>笔者SDK是java 8，如果你的SDK列表为空，那你需要窗口中找到 “+” 这个按钮手动添加SDK，选择你的JDK家目录点击ok。最好是选择与运行maven时所用的JDK相同，maven运行所用的JDK可以通过mvn -version来查看。</p>
</li>
<li><p>SDK配置好后，点击next完成项目导入</p>
</li>
<li><p>在进行源码编译前，可以先浏览一下flink-parent根目录的pom.xml中配置，很复杂…</p>
</li>
<li><p>可以先给maven配置阿里云镜像进行依赖的快速下载，但是会引入其他问题本文相应地方会讨论如何解决。(为了操作方便你也可以直接在pom文件中配置镜像)</p>
<pre><code>#在maven的配置文件中添加国内镜像配置，加速项目依赖的下载
vim ~/.m2/settings.xml
#在&lt;mirrors&gt;&lt;/mirrors&gt;中添加一下两个阿里云镜像
        &lt;mirror&gt;
         &lt;id&gt;nexus-aliyun&lt;/id&gt;
         &lt;mirrorOf&gt;*,!jeecg,!jeecg-snapshots,!mapr-releases&lt;/mirrorOf&gt;
         &lt;name&gt;Nexus aliyun&lt;/name&gt;
         &lt;url&gt;http://maven.aliyun.com/nexus/content/groups/public&lt;/url&gt;
     &lt;/mirror&gt;
     &lt;mirror&gt;
         &lt;id&gt;mapr-public&lt;/id&gt;
         &lt;mirrorOf&gt;mapr-releases&lt;/mirrorOf&gt;
         &lt;name&gt;mapr-releases&lt;/name&gt;
         &lt;url&gt;https://maven.aliyun.com/repository/mapr-public&lt;/url&gt;
     &lt;/mirror&gt;
#:wq!保存退出 </code></pre></li>
<li><p>回到项目在侧工具栏中点击maven下图中按钮reimport，进行依赖的下载和导入<img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysk78d9j314k0n841d.jpg" alt="image-20200303161020964"></p>
</li>
<li><p>后台依赖下载导入结束后发现pom.xml文件中还是有报错显示红色的依赖，意味着这些依赖jar在配置的阿里云镜像仓库中没有，无法下载到本地maven仓库。因此可以回到maven配置文件，将刚刚配置的阿里云镜像mirror标签注释掉，直接从maven国际中央镜像仓库去下载。回到项目中maven reimport继续下载报错显示红色的依赖。完成后发现报错显示红色的地方少了些，但还是有，意味着有些依赖中央仓库也没有(不知道flink项目组用的什么镜像仓库导入的这些依赖..)。那没辙了只能用最后一个本办法，手动向本地maven库添加需要的jar包。以下图这个依赖为例(笔者当时下载依赖时下面这个插件依赖就是报错之一下载不下来)。</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbyshhdexj30lw0au0u4.jpg" alt="image-20200303162212756"></p>
<pre><code class="sh">#我们知道maven是G-A-V的结构，所以maven本地仓库中的依赖jar就保存在对应依赖信息的文件夹下，比如上图这个依赖就位于下面这个文件夹下
~/.m2/repository/org/apache/maven/plugins/maven-javadoc-plugin/2.9.1/
#你可以先在终端cd这个文件夹，由于maven下载时报错了找不到这个依赖，故cd这个文件夹应该是无法到达的
#我们要做的是按照依赖信息手动创建文件夹，去maven仓库官网手动下载jar，而后将其复制到该目录下
</code></pre>
<p>浏览器访问<a href="https://mvnrepository.com/" target="_blank" rel="noopener">https://mvnrepository.com/</a> , 搜索maven-javadoc-plugin，选择和依赖信息匹配的点击进入<img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysm6lnsj31md0u0tgm.jpg" alt="image-20200303163553359"></p>
<p>找到对应的版本</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysnt7irj31bp0u0n6x.jpg" alt="image-20200303163803190"></p>
<p>点击红框所示位置会自动将jar下载下来</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysiclhnj31qa0u0n4v.jpg" alt="image-20200303163846243"></p>
<p>而后将其添加到路径下</p>
<pre><code>cp ~/Downloads/maven-javadoc-plugin-2.9.1.jar ~/.m2/repository/org/apache/maven/plugins/maven-javadoc-plugin/2.9.1/</code></pre><p>这样就将下载不来开的依赖jar手动添加了</p>
<p>还差一步，手动向maven本地仓库添加了jar包，IDEA并不知道，因此还需要更新一下maven本地仓库的索引。IDEA settings -&gt; build,Execution,Deployment -&gt; build tools -&gt; maven -&gt; Repositories -&gt; 右侧选择type为local的本地仓库，点击update进行索引更新，这样IDEA就能检测到你手动添加的jar包了。</p>
</li>
</ol>
<h3 id="编译前简化pom配置："><a href="#编译前简化pom配置：" class="headerlink" title="编译前简化pom配置："></a>编译前简化pom配置：</h3><p>pom.xml文件不再报错时可以进行编译了，编译前可以将一些造成报错的或者不重要的配置注释掉。</p>
<ol>
<li>flink-parent pom.xml 大约1284-1453行，关于开源软件授权认证的部分注释掉；</li>
</ol>
<pre><code>&lt;!--&lt;plugin&gt;
                &lt;groupId&gt;org.apache.rat&lt;/groupId&gt;
                &lt;artifactId&gt;apache-rat-plugin&lt;/artifactId&gt;
                &lt;version&gt;0.12&lt;/version&gt;&amp;lt;!&amp;ndash;$NO-MVN-MAN-VER$&amp;ndash;&amp;gt;
                &lt;inherited&gt;false&lt;/inherited&gt;
                &lt;executions&gt;
                    &lt;execution&gt;
                        &lt;phase&gt;verify&lt;/phase&gt;
                        &lt;goals&gt;
                            &lt;goal&gt;check&lt;/goal&gt;
                        &lt;/goals&gt;
                    &lt;/execution&gt;
                &lt;/executions&gt;
                &lt;configuration&gt;
                    &lt;excludeSubProjects&gt;false&lt;/excludeSubProjects&gt;
                    &lt;numUnapprovedLicenses&gt;0&lt;/numUnapprovedLicenses&gt;
                    &lt;licenses&gt;
                        &amp;lt;!&amp;ndash; Enforce this license:
                            Licensed to the Apache Software Foundation (ASF) under one
                            or more contributor license agreements.  See the NOTICE file
                            distributed with this work for additional information
                            regarding copyright ownership.  The ASF licenses this file
                            to you under the Apache License, Version 2.0 (the
                            &quot;License&quot;); you may not use this file except in compliance
                            with the License.  You may obtain a copy of the License at
                              http://www.apache.org/licenses/LICENSE-2.0
                            Unless required by applicable law or agreed to in writing,
                            software distributed under the License is distributed on an
                            &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
                            KIND, either express or implied.  See the License for the
                            specific language governing permissions and limitations
                            under the License.
                        &amp;ndash;&amp;gt;
                        &lt;license implementation=&quot;org.apache.rat.analysis.license.SimplePatternBasedLicense&quot;&gt;
                            &lt;licenseFamilyCategory&gt;AL2 &lt;/licenseFamilyCategory&gt;
                            &lt;licenseFamilyName&gt;Apache License 2.0&lt;/licenseFamilyName&gt;
                            &lt;notes /&gt;
                            &lt;patterns&gt;
                                &lt;pattern&gt;Licensed to the Apache Software Foundation (ASF) under one&lt;/pattern&gt;
                            &lt;/patterns&gt;
                        &lt;/license&gt;
                    &lt;/licenses&gt;
                    &lt;licenseFamilies&gt;
                        &lt;licenseFamily implementation=&quot;org.apache.rat.license.SimpleLicenseFamily&quot;&gt;
                            &lt;familyName&gt;Apache License 2.0&lt;/familyName&gt;
                        &lt;/licenseFamily&gt;
                    &lt;/licenseFamilies&gt;
                    &lt;excludes&gt;
                        &amp;lt;!&amp;ndash; Additional files like .gitignore etc.&amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/.*/**&lt;/exclude&gt;
                        &lt;exclude&gt;**/*.prefs&lt;/exclude&gt;
                        &lt;exclude&gt;**/*.log&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; External web libraries. &amp;ndash;&amp;gt;
                        &lt;exclude&gt;docs/**/jquery*&lt;/exclude&gt;
                        &lt;exclude&gt;docs/**/bootstrap*&lt;/exclude&gt;
                        &lt;exclude&gt;docs/Gemfile.lock&lt;/exclude&gt;
                        &lt;exclude&gt;docs/ruby2/Gemfile.lock&lt;/exclude&gt;
                        &lt;exclude&gt;docs/img/*.svg&lt;/exclude&gt;
                        &lt;exclude&gt;**/docs/page/font-awesome/**&lt;/exclude&gt;
                        &lt;exclude&gt;**/resources/**/font-awesome/**&lt;/exclude&gt;
                        &lt;exclude&gt;**/resources/**/jquery*&lt;/exclude&gt;
                        &lt;exclude&gt;**/resources/**/bootstrap*&lt;/exclude&gt;
                        &lt;exclude&gt;flink-clients/src/main/resources/web-docs/js/*d3.js&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; the licenses that are re-bundled &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/packaged_licenses/LICENSE.*.txt&lt;/exclude&gt;
                        &lt;exclude&gt;**/licenses/LICENSE*&lt;/exclude&gt;
                        &lt;exclude&gt;**/licenses-binary/LICENSE*&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; web dashboard config JSON files &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/package.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/package-lock.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/angular.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/proxy.conf.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/tsconfig.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/tslint.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/src/browserslist&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/src/tsconfig.app.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/src/tsconfig.spec.json&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/src/tslint.json&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; web dashboard non-binary assets &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/src/assets/**&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; generated contents &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/web/**&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; downloaded and generated web libraries. &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/node_modules/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime-web/web-dashboard/node/**&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; Test Data. &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/src/test/resources/*-data&lt;/exclude&gt;
                        &lt;exclude&gt;flink-tests/src/test/resources/testdata/terainput.txt&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-avro/src/test/resources/flink_11-kryo_registrations&lt;/exclude&gt;
                        &lt;exclude&gt;flink-runtime/src/test/resources/flink_11-kryo_registrations&lt;/exclude&gt;
                        &lt;exclude&gt;flink-core/src/test/resources/kryo-serializer-config-snapshot-v1&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-avro/src/test/resources/avro/*.avsc&lt;/exclude&gt;
                        &lt;exclude&gt;out/test/flink-avro/avro/user.avsc&lt;/exclude&gt;
                        &lt;exclude&gt;flink-table/flink-table-planner/src/test/scala/resources/*.out&lt;/exclude&gt;
                        &lt;exclude&gt;flink-table/flink-table-planner-blink/src/test/resources/digest/*.out&lt;/exclude&gt;
                        &lt;exclude&gt;flink-table/flink-table-planner-blink/src/test/resources/explain/*.out&lt;/exclude&gt;
                        &lt;exclude&gt;flink-yarn/src/test/resources/krb5.keytab&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/test-scripts/test-data/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/test-scripts/docker-hadoop-secure-cluster/config/keystore.jks&lt;/exclude&gt;
                        &lt;exclude&gt;flink-connectors/flink-connector-kafka/src/test/resources/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-connectors/flink-connector-kafka-0.11/src/test/resources/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-connectors/flink-connector-hive/src/test/resources/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/flink-tpcds-test/tpcds-tool/answer_set/*&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/flink-tpcds-test/tpcds-tool/query/*&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; snapshots &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/src/test/resources/*-snapshot&lt;/exclude&gt;
                        &lt;exclude&gt;**/src/test/resources/*.snapshot&lt;/exclude&gt;
                        &lt;exclude&gt;**/src/test/resources/*-savepoint&lt;/exclude&gt;
                        &lt;exclude&gt;flink-core/src/test/resources/serialized-kryo-serializer-1.3&lt;/exclude&gt;
                        &lt;exclude&gt;flink-core/src/test/resources/type-without-avro-serialized-using-kryo&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-avro/src/test/resources/flink-1.4-serializer-java-serialized&lt;/exclude&gt;

                        &lt;exclude&gt;flink-end-to-end-tests/flink-state-evolution-test/src/main/java/org/apache/flink/avro/generated/*&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/flink-state-evolution-test/savepoints/*&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-avro/src/test/resources/testdata.avro&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-avro/src/test/java/org/apache/flink/formats/avro/generated/*.java&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-parquet/src/test/java/org/apache/flink/formats/parquet/generated/*.java&lt;/exclude&gt;
                        &lt;exclude&gt;flink-formats/flink-parquet/src/test/resources/avro/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; netty test file, still Apache License 2.0 but with a different header &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-runtime/src/test/java/org/apache/flink/runtime/io/network/buffer/AbstractByteBufTest.java&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Configuration Files. &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/flink-bin/conf/slaves&lt;/exclude&gt;
                        &lt;exclude&gt;**/flink-bin/conf/masters&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Administrative files in the main trunk. &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/README.md&lt;/exclude&gt;
                        &lt;exclude&gt;.github/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Build files &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/*.iml&lt;/exclude&gt;
                        &lt;exclude&gt;flink-quickstart/**/testArtifact/goal.txt&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Generated content &amp;ndash;&amp;gt;
                        &lt;exclude&gt;out/**&lt;/exclude&gt;
                        &lt;exclude&gt;**/target/**&lt;/exclude&gt;
                        &lt;exclude&gt;docs/content/**&lt;/exclude&gt;
                        &lt;exclude&gt;**/scalastyle-output.xml&lt;/exclude&gt;
                        &lt;exclude&gt;build-target/**&lt;/exclude&gt;
                        &lt;exclude&gt;docs/_includes/generated/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Tools: watchdog &amp;ndash;&amp;gt;
                        &lt;exclude&gt;tools/artifacts/**&lt;/exclude&gt;
                        &lt;exclude&gt;tools/flink*/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Tools: japicmp output &amp;ndash;&amp;gt;
                        &lt;exclude&gt;tools/japicmp-output/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; artifacts created during release process &amp;ndash;&amp;gt;
                        &lt;exclude&gt;tools/releasing/release/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; manually installed version on travis &amp;ndash;&amp;gt;
                        &lt;exclude&gt;apache-maven-3.2.5/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; PyCharm &amp;ndash;&amp;gt;
                        &lt;exclude&gt;**/.idea/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Generated code via Avro &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-end-to-end-tests/flink-confluent-schema-registry/src/main/java/example/avro/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-end-to-end-tests/flink-datastream-allround-test/src/main/java/org/apache/flink/streaming/tests/avro/**&lt;/exclude&gt;
                        &amp;lt;!&amp;ndash; Files generated by jepsen tests &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-jepsen/store/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-jepsen/docker/id_rsa*&lt;/exclude&gt;
                        &lt;exclude&gt;flink-jepsen/docker/nodes&lt;/exclude&gt;

                        &amp;lt;!&amp;ndash; flink-python &amp;ndash;&amp;gt;
                        &lt;exclude&gt;flink-python/lib/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-python/dev/download/**&lt;/exclude&gt;
                        &lt;exclude&gt;flink-python/docs/_build/**&lt;/exclude&gt;
                    &lt;/excludes&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;--&gt;

</code></pre><ol start="2">
<li>1697-1725行，关于代码风格检查的部分注释掉；</li>
</ol>
<pre><code>&lt;!--&lt;plugin&gt;
                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                    &lt;artifactId&gt;maven-checkstyle-plugin&lt;/artifactId&gt;
                    &lt;version&gt;2.17&lt;/version&gt;
                    &lt;dependencies&gt;
                        &lt;dependency&gt;
                            &lt;groupId&gt;com.puppycrawl.tools&lt;/groupId&gt;
                            &lt;artifactId&gt;checkstyle&lt;/artifactId&gt;
                            &amp;lt;!&amp;ndash; Note: match version with docs/flinkDev/ide_setup.md &amp;ndash;&amp;gt;
                            &lt;version&gt;8.14&lt;/version&gt;
                        &lt;/dependency&gt;
                    &lt;/dependencies&gt;
                    &lt;executions&gt;
                        &lt;execution&gt;
                            &lt;id&gt;validate&lt;/id&gt;
                            &lt;phase&gt;validate&lt;/phase&gt;
                            &lt;goals&gt;
                                &lt;goal&gt;check&lt;/goal&gt;
                            &lt;/goals&gt;
                        &lt;/execution&gt;
                    &lt;/executions&gt;
                    &lt;configuration&gt;
                        &lt;suppressionsLocation&gt;/tools/maven/suppressions.xml&lt;/suppressionsLocation&gt;
                        &lt;includeTestSourceDirectory&gt;true&lt;/includeTestSourceDirectory&gt;
                        &lt;configLocation&gt;/tools/maven/checkstyle.xml&lt;/configLocation&gt;
                        &lt;logViolationsToConsole&gt;true&lt;/logViolationsToConsole&gt;
                        &lt;failOnViolation&gt;true&lt;/failOnViolation&gt;
                    &lt;/configuration&gt;
                &lt;/plugin&gt;--&gt;</code></pre><p>我主要注释掉了以上两部分，其他的读者可以视情况注释掉一些不重要的配置。</p>
<p><strong>开始编译：</strong></p>
<pre><code>mvn clean package -T 4 -Dfast -DskipTests -Dscala-2.11</code></pre><h3 id="编译报错记录："><a href="#编译报错记录：" class="headerlink" title="编译报错记录："></a>编译报错记录：</h3><pre><code>[INFO] --- frontend-maven-plugin:1.6:npm (npm install) @ flink-runtime-web_2.11 ---
[INFO] Running &#39;npm ci --cache-max=0 --no-save&#39; in /home/ben/work/flink/flink-runtime-web/web-dashboard
[WARNING] npm WARN prepare removing existing node_modules/ before installation
[ERROR] Failed to execute goal on project flink-avro-confluent-registry: Could not resolve dependencies for project org.apache.flink:flink-avro-confluent-registry:jar:1.11-SNAPSHOT: Failure to find io.confluent:kafka-schema-registry-client:jar:4.1.0 in http://maven.aliyun.com/nexus/content/groups/public was cached in the local repository, resolution will not be reattempted until the update interval of nexus-aliyun has elapsed or updates are forced -&gt; [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/DependencyResolutionException
[ERROR] 
[ERROR] After correcting the problems, you can resume the build with the command
[ERROR]   mvn &lt;goals&gt; -rf :flink-avro-confluent-registry</code></pre><p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysmllvlj32n60buq8e.jpg" alt="image-20200303153603693"></p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysllgsmj312e07g0vm.jpg" alt="image-20200303171611150"></p>
<p>原因：中央仓库没有这个jar        </p>
<p>解决: 阿里云镜像有，maven配置文件添加阿里云镜像重新编译</p>
<p>[ERROR] Failed to execute goal org.apache.maven.plugins:maven-dependency-plugin:3.1.1:copy (copy-zk-jars) on project flink-dist_2.11: Unable to find/resolve artifact.: Could not transfer artifact org.apache.flink:flink-shaded-zookeeper-3:jar:3.5.6-10.0 from/to central (<a href="https://repo.maven.apache.org/maven2" target="_blank" rel="noopener">https://repo.maven.apache.org/maven2</a>): GET request of: org/apache/flink/flink-shaded-zookeeper-3/3.5.6-10.0/flink-shaded-zookeeper-3-3.5.6-10.0.jar from central failed: Premature end of Content-Length delimited message body (expected: 8025773; received: 2009407 -&gt; [Help 1]<br>[ERROR]<br>[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.<br>[ERROR] Re-run Maven using the -X switch to enable full debug logging.<br>[ERROR]<br>[ERROR] For more information about the errors and possible solutions, please read the following articles:<br>[ERROR] [Help 1] <a href="http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException" target="_blank" rel="noopener">http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException</a><br>[ERROR]<br>[ERROR] After correcting the problems, you can resume the build with the command<br>[ERROR]   mvn <goals> -rf :flink-dist_2.11</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysjpvnqj32me0f2dm0.jpg" alt="image-20200303161156846"></p>
<p>阿里云下载不到这个jar，再换国际镜像重新编译(反正都是某个jar依赖下载失败，这个镜像不行就换另一个镜像)</p>
<p><img src="https://tva1.sinaimg.cn/large/00831rSTly1gdbysj7rktj30xc0eun0l.jpg" alt="image-20200303192151151"></p>
<p><strong>success！</strong></p>

            <!--[if lt IE 9]><script>document.createElement('audio');</script><![endif]-->
            <audio id="audio" loop="1" preload="auto" controls="controls"
                data-autoplay="false">
                <source type="audio/mpeg" src="">
            </audio>
            
            <ul id="audio-list" style="display:none">
                
                
                <li title='0' data-url='/statics/chengdu.mp3'></li>
                
                    
            </ul>
            
            
            
            <div id="vcomments"></div>
            
        </div>
        <div class="sidebar">
            <div class="box animated fadeInRight">
                <div class="subbox">
                    <img src="https://res.cloudinary.com/tridiamond/image/upload/v1573019751/TriDiamond_logo_ui_xeublz.jpg" height=300 width=300></img>
                    <p>lixiaolevae</p>
                    <span>Think like an artist, develop like an artisan</span>
                    <dl>
                        <dd><a href="https://github.com/TriDiamond" target="_blank"><span
                                    class=" iconfont icon-github"></span></a></dd>
                        <dd><a href="https://twitter.com/TriDiamond6" target="_blank"><span
                                    class=" iconfont icon-twitter"></span></a></dd>
                        <dd><a href="https://stackoverflow.com/users/7602324/tridiamond?tab=profile" target="_blank"><span
                                    class=" iconfont icon-stack-overflow"></span></a></dd>
                    </dl>
                </div>
                <ul>
                    <li><a href="/">4 <p>Articles</p></a></li>
                    <li><a href="/categories">3 <p>Categories</p></a></li>
                    <li><a href="/tags">4 <p>Tags</p></a></li>
                </ul>
            </div>
            
            
            
            <div class="box sticky animated fadeInRight faster">
                <div id="toc" class="subbox">
                    <h4>Contents</h4>
                    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#前提环境："><span class="toc-number">1.</span> <span class="toc-text">前提环境：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#克隆项目："><span class="toc-number">2.</span> <span class="toc-text">克隆项目：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#项目导入IDE："><span class="toc-number">3.</span> <span class="toc-text">项目导入IDE：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编译前简化pom配置："><span class="toc-number">4.</span> <span class="toc-text">编译前简化pom配置：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#编译报错记录："><span class="toc-number">5.</span> <span class="toc-text">编译报错记录：</span></a></li></ol>
                </div>
            </div>
            
            
        </div>
    </div>
</div>

    </div>
</div>
    <div id="back-to-top" class="animated fadeIn faster">
        <div class="flow"></div>
        <span class="percentage animated fadeIn faster">0%</span>
        <span class="iconfont icon-top02 animated fadeIn faster"></span>
    </div>
</body>
<footer>
    <p class="copyright" id="copyright">
        &copy; 2020
        <span class="gradient-text">
            lixiaolevae
        </span>.
        Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a>
        Theme
        <span class="gradient-text">
            <a href="https://github.com/TriDiamond/hexo-theme-obsidian" title="Obsidian" target="_blank" rel="noopener">Obsidian</a>
        </span>
        <small><a href="https://github.com/TriDiamond/hexo-theme-obsidian/blob/master/CHANGELOG.md" title="v1.4.3" target="_blank" rel="noopener">v1.4.3</a></small>
    </p>
</footer>

<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
<script>
  MathJax.Hub.Config({
    "HTML-CSS": {
      preferredFont: "TeX",
      availableFonts: ["STIX", "TeX"],
      linebreaks: {
        automatic: true
      },
      EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
      inlineMath: [
        ["$", "$"],
        ["\\(", "\\)"]
      ],
      processEscapes: true,
      ignoreClass: "tex2jax_ignore|dno",
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
      noUndefined: {
        attributes: {
          mathcolor: "red",
          mathbackground: "#FFEEEE",
          mathsize: "90%"
        }
      },
      Macros: {
        href: "{}"
      }
    },
    messageStyle: "none"
  });
</script>
<script>
  function initialMathJax() {
    MathJax.Hub.Queue(function () {
      var all = MathJax.Hub.getAllJax(),
        i;
      // console.log(all);
      for (i = 0; i < all.length; i += 1) {
        console.log(all[i].SourceElement().parentNode)
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  }

  function reprocessMathJax() {
    if (typeof MathJax !== 'undefined') {
      MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
    }
  }
</script>




<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script src="/js/plugin.js"></script>
<script src="/js/obsidian.js"></script>
<script src="/js/jquery.truncate.js"></script>
<script src="/js/search.js"></script>


<script src="//cdn.bootcss.com/typed.js/2.0.10/typed.min.js"></script>


<script src="//cdn.bootcss.com/blueimp-md5/2.12.0/js/md5.min.js"></script>


<script src="//cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js"></script>


<script src="https://cdn.bootcss.com/codemirror/5.48.4/codemirror.min.js"></script>

    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/javascript/javascript.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/css/css.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/xml/xml.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/htmlmixed/htmlmixed.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/clike/clike.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/php/php.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/shell/shell.min.js"></script>


    
<script src="//cdn.bootcss.com/codemirror/5.48.4/mode/python/python.min.js"></script>






<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="//cdn.bootcss.com/photoswipe/4.1.3/default-skin/default-skin.min.css">


<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//cdn.bootcss.com/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>


<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>
    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">
        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>
        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">
            <div class="pswp__top-bar">
                <!--  Controls are self-explanatory. Order can be changed. -->
                <div class="pswp__counter"></div>
                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
                <button class="pswp__button pswp__button--share" title="Share"></button>
                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                      <div class="pswp__preloader__cut">
                        <div class="pswp__preloader__donut"></div>
                      </div>
                    </div>
                </div>
            </div>
            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div> 
            </div>
            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>
            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>
            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>
        </div>
    </div>
</div>



    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="//www.googletagmanager.com/gtag/js?id=UA-149874671-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-149874671-1');
    </script>





<script>
    function initialTyped () {
        var typedTextEl = $('.typed-text');
        if (typedTextEl && typedTextEl.length > 0) {
            var typed = new Typed('.typed-text', {
                strings: ["Think like an artist, develop like an artisan", "艺术家思维去思考问题，工匠创造精神去开发"],
                typeSpeed: 90,
                loop: true,
                loopCount: Infinity,
                backSpeed: 20,
            });
        }
    }

    if ($('.article-header') && $('.article-header').length) {
        $(document).ready(function () {
            initialTyped();
        });
    }
</script>


    
<script src="//unpkg.com/valine/dist/Valine.min.js"></script>

    <script>

        var valine = new Valine();

        function initValine(path) {
            if (!path) path = window.location.pathname;
            let language = 'en';
            if (!language) {
                language = 'en';
            } else {
                language = language.toLowerCase();
            }
            valine.init({
                el: '#vcomments',
                appId: 'QHCOIEBlyjBUMAjaE5ilzafk-gzGzoHsz',
                appKey: 'ggeGwz8ypB9uiAIYSRH5T0PF',
                notify: 'false',
                verify: 'false',
                avatar: 'mp',
                placeholder: 'Leave your throughs behind~',
                visitor: 'true',
                path: path,
                lang: language
            });
        }

        $(document).ready(function () {
            initValine();
        });
    </script>



</html>
